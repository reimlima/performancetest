<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta http-equiv="refresh" content="120">
		<title>Black Friday | Tempo de Carregamento de Pagina dos Grandes Varejistas</title>
		<link rel="stylesheet" href="css/mystats.css" type="text/css">
		<script src="amcharts/amcharts.js" type="text/javascript"></script>
		<script src="amcharts/serial.js" type="text/javascript"></script>

		<script type="text/javascript">
			var chart;
			var chartData;
			
			AmCharts.loadJSON = function(file){
				var request;
				if (window.XMLHttpRequest) {
					request = new XMLHttpRequest();
					// load
					request.open('GET', file, false);
					request.send();
					return eval(request.responseText)
					//setData(request.responseText);
				}
			};
			
			AmCharts.ready(function () {
				// SERIAL CHART
				chart = new AmCharts.AmSerialChart();
				chart.pathToImages = "amcharts/images/";
				chart.dataProvider = AmCharts.loadJSON('file.json');
				chart.categoryField = "date";
				chart.dataDateFormat = "DD-MM-YYYY JJ:NN";

				// AXES
				// category
				var categoryAxis = chart.categoryAxis;
				categoryAxis.parseDates = false; // as our data is date-based, we set parseDates to true
				categoryAxis.minPeriod = "NN"; // our data is per minute, so we set minPeriod to NN
				categoryAxis.minorGridEnabled = true;
				categoryAxis.axisColor = "#DADADA";
				categoryAxis.dateFormats = [ 
					{ period: 'DD', format: 'DD' }, 
					{ period: 'MM', format: 'MM' }, 
					{ period: 'YYYY', format: 'YYYY' }, 
					{ period: 'JJ', format: 'JJ' }, 
					{ period: 'NN', format: 'NN'} ];

				var valueAxis1 = new AmCharts.ValueAxis();
				valueAxis1.axisColor = "#FF6600";
				valueAxis1.axisThickness = 1;
				valueAxis1.gridAlpha = 0;
				chart.addValueAxis(valueAxis1);

				var valueAxis2 = new AmCharts.ValueAxis();
				valueAxis2.position = "right"; // this line makes the axis to appear on the right
				valueAxis2.axisColor = "#FCD202";
				valueAxis2.gridAlpha = 0;
				valueAxis2.axisThickness = 1;
				chart.addValueAxis(valueAxis2);

				valueAxis3 = new AmCharts.ValueAxis();
				valueAxis3.offset = 50; // this line makes the axis to appear detached from plot area
				valueAxis3.gridAlpha = 0;
				valueAxis3.axisColor = "#B0DE09";
				valueAxis3.axisThickness = 1;
				chart.addValueAxis(valueAxis3);

				// GRAPHS
				var graph1 = new AmCharts.AmGraph();
				graph1.valueAxis = valueAxis1; // we have to indicate which value axis should be used
				graph1.title = "amazon";
				graph1.valueField = "amazon";
				graph1.bullet = "round";
				graph1.hideBulletsCount = 30;
				graph1.bulletBorderThickness = 1;
				chart.addGraph(graph1);

				var graph2 = new AmCharts.AmGraph();
				graph2.valueAxis = valueAxis2; // we have to indicate which value axis should be used
				graph2.title = "bestbuy";
				graph2.valueField = "bestbuy";
				graph2.bullet = "round";
				graph2.hideBulletsCount = 30;
				graph2.bulletBorderThickness = 1;
				chart.addGraph(graph2);

				var graph3 = new AmCharts.AmGraph();
				graph3.valueAxis = valueAxis3; // we have to indicate which value axis should be used
				graph3.title = "wallmart";
				graph3.valueField = "wallmart";
				graph3.bullet = "round";
				graph3.hideBulletsCount = 30;
				graph3.bulletBorderThickness = 1;
				chart.addGraph(graph3);

				// CURSOR
				var chartCursor = new AmCharts.ChartCursor();
				chartCursor.cursorPosition = "mouse";
				chart.addChartCursor(chartCursor);

				// SCROLLBAR
				var chartScrollbar = new AmCharts.ChartScrollbar();
				chart.addChartScrollbar(chartScrollbar);

				// LEGEND
				var legend = new AmCharts.AmLegend();
				legend.marginLeft = 110;
				legend.useGraphSettings = true;
				chart.addLegend(legend);

				// WRITE
				chart.write("chartdiv");
			});

			// this method is called when chart is first inited as we listen for "dataUpdated" event
			function zoomChart() {
			// different zoom methods can be used - zoomToIndexes, zoomToDates, zoomToCategoryValues
				chart.zoomToIndexes(10, 20);
			}
		</script>
	</head>
	<body>
		<div id="chartdiv" style="width: 100%; height: 400px;"></div>
		Gr&aacute;fico com os dados de tempo de carregamento de p&aacute;gina dos principais varejistas Brasileiros<br>
		<br>
		Considera&ccedil;&otilde;es:<br>
		- Os valores exibidos quando se passa o mouse est&atilde;o em segundos com a precis&atilde;o de 3 casas decimais depois da v&iacute;rgula;<br>
		- Valor "0" quer dizer que o Site do varejista demorou mais de 30 segundos para responder;<br>
		- A falta de dados em algum per&iacute;odo significa que a execu&ccedil;&atilde;o anterior demorou mais de 2 minutos para terminar e a execu&ccedil;&atilde;o "atual" n&atilde;o conseguiu rodar;<br>
		- Clique no nome de algum varejista para "desligar" e "ligar" a exibi&ccedil;&atilde;o da m&eacute;trica;<br>
		- Os testes foram executados a partir de uma VM Hospedada fora do Brasil, logo &eacute; a simula&ccedil;&atilde;o de um acesso vindo do exterior;<br>
		- Esse &eacute; um beta v1, ent&atilde;o est&aacute; bem b&aacute;sico, sem muita firula e exibindo basicamente os dados coletados, mas faz o que eu me propus a fazer;<br>
		<br>
		Feito em:<br>
		Javascript (amcharts);<br>
		PhantomJS;<br>
		JSON;<br>
		Shell Script;<br>
		<!-- Atualiza&ccedil;&atilde;o a cada 2 min&uacute;tos;-->
	</body>
</html>
